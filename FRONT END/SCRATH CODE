

<py-config>
    packages = ["matplotlib", "pandas", "seaborn", "numpy", "scipy", "tensorflow" ]

</py-config>

<!------------py-config---------------------  -->
<py-config>
    paths = ['FRONT END\data_loader.py']

</py-config>
<py-script>
    import data_loader.py


<!------------TensorFlow---------------------  -->



import pandas as pd
import numpy as np
from scipy.stats import zscore
import tensorflow as tf
from tensorflow import keras



class Data_Model:
    model=None
    data =None
    bins= [0.0,0.25,0.50,0.75,1.0]
    bin_names =['Not likely', 'Less Likely', 'Likely', 'Highly likely']
    def __init__(self):
        print('init called')
        data = pd.read_csv("heart.csv")
        data = self.clean_data(data)
        data.fillna(data.median(), inplace=True)
        self.data = data
        data_norm=data.apply(zscore)
        x= data_norm.drop('HeartDisease',axis =1)
        y= data['HeartDisease']
        x_train,x_test,y_train,y_test = train_test_split(x,y,test_size = 0.2, random_state=42)
        model = keras.Sequential([
            keras.layers.Dense(16, activation='relu', input_shape = (11,)),
            keras.layers.Dense(1, activation='sigmoid')
])
        model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])
        history = model.fit(x_train, y_train, epochs=10, batch_size=32, validation_data=(x_test, y_test))
        score = model.evaluate(x_test, y_test, verbose=0)
        print('Test loss:', score[0])
        print('Test accuracy:', score[1])
        self.model = model


    def predict_with_model(self, data):
# function takes in data and returns the predictions for this data.
# if there is missing value in the data it will autofill it.
# prediction also includes sorting it to a liklyhood bin
        if self.model is None:
            print('model is None')
            return None
        data.fillna(self.data.median(), inplace=True)
        data_norm = data.apply(zscore)
        prediction= self.model.predict(data_norm)
        bin_indices = np.digitize(prediction, self.bins)
        bin_indices = bin_indices.flatten()
        bin_values = [self.bin_names[i - 1] for i in bin_indices]
        result = np.concatenate([prediction, np.array(bin_values)[:, None]], axis=1)
        return result


    def clean_data (self, data):
        sex_mapping = {'M': 0, 'F': 1}
        ST_Slope_mapping = {'Flat': 0, 'Up': 1, 'Down': -1}
        ChestPainType_mapping = {'ASY': 0, 'NAP': 20, 'ATA': 50, 'TA': 70}
        ExerciseAngina_mapping = {'N': 0, 'Y': 1}
        RestingECG_mapping = {'Normal': 0, 'ST': 1}
        data['RestingECG'] = data['RestingECG'].map(RestingECG_mapping)
        data['ExerciseAngina'] = data['ExerciseAngina'].map(ExerciseAngina_mapping)
        data['ChestPainType'] = data['ChestPainType'].map(ChestPainType_mapping)
        data['ST_Slope'] = data['ST_Slope'].map(ST_Slope_mapping)
        data['Sex'] = data['Sex'].map(sex_mapping)
        return data

</py-script>


///////////////////////////////////////////////////////////////////////////////

<py-script src= "pythonfile.py" >

</py-script>


<h2>Testing v0</h2>

/////////////////////////////////////////////////////////////////////////////////
<!------------Testing UserInput in Scatt---------------------  -->
<h2>Enter User Health Information?</h2>
<div class="health-container">
    <form onsubmit="return false">
        <div>
            <label class="health-label" for="cholesterol">Cholesterol Level:</label>
            <input type="number" class="health-input" id="cholesterol" name="cholesterol" maxlength="3" required>
            <span id="cholesterol-error" style="color: red;"></span>
        </div>
        <div>
            <label class="health-label" for="blood-pressure">Blood Pressure:</label>
            <input type="number" class="health-input" id="blood-pressure" name="blood_pressure" maxlength="3" required>
            <span id="blood-pressure-error" style="color: red;"></span>
        </div>

        <input onclick="submitForm1()" type="submit" id="btn-form-1" value="submit">

    </form>

    <p>Output:</p>
    <p id='output1'></p>

    <script>
        function submitForm1() {
            var cholesterolInput = document.getElementById("cholesterol");
            var cholesterolError = document.getElementById("cholesterol-error");
            var bloodPressureInput = document.getElementById("blood-pressure");
            var bloodPressureError = document.getElementById("blood-pressure-error");

            validateCholesterol();
            validateBloodPressure();

            function validateCholesterol() {
                var cholesterol = cholesterolInput.value;
                if (cholesterol < 10 || cholesterol > 500) {
                    cholesterolError.textContent = "Invalid cholesterol level. Cholesterol level must be between 10 and 500.";
                    cholesterolInput.focus();
                } else {
                    cholesterolError.textContent = "";
                }
            }

            function validateBloodPressure() {
                var bloodPressure = bloodPressureInput.value;
                if (bloodPressure < 50 || bloodPressure > 180) {
                    bloodPressureError.textContent = "Invalid blood pressure. Blood pressure must be between 50 and 180.";
                    bloodPressureInput.focus();
                } else {
                    bloodPressureError.textContent = "";
                }
            }
        }
    </script>

    <py-script>
        import js
        import pandas as pd
        import matplotlib.pyplot as plt
        import seaborn as sns

        def submitHealthInfo():
            cholesterol = float(js.document.getElementById("cholesterol").value)
            bloodPressure = float(js.document.getElementById("blood-pressure").value)

            if 10 <= cholesterol <= 500 and 50 <= bloodPressure <= 180:
                df = pd.DataFrame({'Cholesterol': [cholesterol], 'RestingBP': [bloodPressure], 'Target': [0]})
                plt.figure()
                sns.scatterplot(data=df, x="Cholesterol", y="RestingBP", hue="Target")
                plt.title('Resting Blood Pressure vs Cholesterol')
                plt.xlabel('Cholesterol')
                plt.ylabel('Resting Blood Pressure')
                plt.plot([cholesterol], [bloodPressure], 'ks')  # Add black square for user input
                plt.savefig("plot.png")
                js.plotSaved("plot.png")
                print("working?")
            else:
                js.alert("Invalid input. Cholesterol must be between 10 and 500, and blood pressure must be between 50 and 180.")
    </py-script>
/////////////////////////////////////////////////////


<div class="container">
    <nav>
        <!-- Navigation links here -->
    </nav>
    <div class="image-container">

    </div>
    <div class="image-grid">
        <div class="image-block">

            <img src="RBPvsCholestrol.jpg" alt="Trulli">

            <img src="RBPvsCholestrol.jpg" alt="Trulli">
        </div>


    </div>
</div>


<!-- OVERLAY OUTPUT HERE -->

<div id="Outputoverlay">
    <div id="left">
        <div class="Outputbox Outputred" onclick="Outputenlarge(this)"></div>
        <div class="Outputbox Outputblue" onclick="Outputenlarge(this)"></div>
        <div class="Outputbox Outputgreen" onclick="Outputenlarge(this)"></div>
        <div class="Outputbox Outputyellow" onclick="Outputenlarge(this)"></div>
    </div>
    <div id="Outputcenter">
        <p>Diagnosis text goes here.</p>
        <button onclick="off()">Done</button>
    </div>
</div>

<div style="padding:500px">
    <h2>Overlay with Text</h2>
    <button onclick="on()">Turn on overlay effect</button>
</div>

<script>
    var OutputenlargedBox;

    function on() {
        document.getElementById("Outputoverlay").style.display = "block";
    }

    function off() {
        document.getElementById("Outputoverlay").style.display = "none";
    }

    function Outputenlarge(Outputbox) {
        OutputenlargedBox = Outputbox.cloneNode(true);
        OutputenlargedBox.classList.add("Ouputenlarge-box");
        Ouputbox.parentElement.parentElement.parentElement.parentElement.parentElement.appendChild(OutputenlargedBox);
    }


</script>
//////////////////////////////////////////////////////////////////////////////////
<style>
    #mytext{
        color: red;

    }
</style>
<div id = "mytext">


</div>
//////////////////////Health Info  Scratch Code//////////////////////////////////////////////////////////////
 <!-- Cholestrol VALIDATION HERE -->
                <form method="post">
                    <label class="health-label" for="cholesterol">Cholesterol Level:</label>
                    <input type="number" class="health-input" id="cholesterol" name="cholesterol" maxlength="3" required>
                    <span id="cholesterol-error" style="color: red;"></span>

                </form>

                <script>
                    var cholesterolInput = document.getElementById("cholesterol");
                    var cholesterolError = document.getElementById("cholesterol-error");

                    cholesterolInput.addEventListener("blur", validateCholesterol);
                    cholesterolInput.addEventListener("keydown", clearCholesterolError);

                    function validateCholesterol() {
                        var cholesterol = cholesterolInput.value;
                        if (cholesterol < 10 || cholesterol > 500) {
                            cholesterolError.textContent = "Invalid cholesterol level. Cholesterol level must be between 10 and 500.";
                            cholesterolInput.focus();
                        } else {
                            cholesterolError.textContent = "";
                        }
                    }

                    function clearCholesterolError() {
                        cholesterolError.textContent = "";
                    }
                </script>
                <!---------------------------------  -->

                <!-- Bloodpressure VALIDATION HERE -->
                <form method="post">
                    <label class="health-label" for="blood-pressure">Blood Pressure:</label>
                    <input type="number" class="health-input" id="blood-pressure" name="blood_pressure" maxlength="3" required>
                    <span id="blood-pressure-error" style="color: red;"></span>

                </form>

                <script>
                    var bloodPressureInput = document.getElementById("blood-pressure");
                    var bloodPressureError = document.getElementById("blood-pressure-error");

                    bloodPressureInput.addEventListener("blur", validateBloodPressure);
                    bloodPressureInput.addEventListener("keydown", clearBloodPressureError);

                    function validateBloodPressure() {
                        var bloodPressure = bloodPressureInput.value;
                        if (bloodPressure < 50 || bloodPressure > 180) {
                            bloodPressureError.textContent = "Invalid blood pressure. Blood pressure must be between 50 and 180.";
                            bloodPressureInput.focus();
                        } else {
                            bloodPressureError.textContent = "";
                        }
                    }

                    function clearBloodPressureError() {
                        bloodPressureError.textContent = "";
                    }
                </script>

                /////////////////////////// scratch//

                <!DOCTYPE html>
                <html>
                <head>
                    <title> Heart Disease Diagnostic</title>
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <link rel="stylesheet" type="text/css" href="Main.css">
                    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

                    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
                    <script defer src="https://pyscript.net/latest/pyscript.js"></script>


                </head>

                <body>

                <py-config>
                    packages = ["matplotlib", "pandas", "seaborn"]

                </py-config>

                <header>
                    <h1 class="title">Heart Disease Diagnostic</h1>
                    <nav>
                        <ul>
                            <li><a href="#">Home</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </nav>
                </header>
                <main>
                    <section>
                        <h2>Enter User Information</h2>
                        <form onsubmit="return false">
                            <label for="name">Name:</label>
                            <input type="text" id="name" name="name" placeholder="ex. John Doe" required>


                            <!-- AGE VALIDATION HERE -->
                            <label for="age">Age (Year):</label>
                            <input type="number" id="age" name="age" required>
                            <span id="age-error" style="color: red;"></span>

                            <script>
                                var ageInput = document.getElementById("age");
                                var ageError = document.getElementById("age-error");

                                ageInput.addEventListener("blur", validateAge);
                                ageInput.addEventListener("keydown", clearAgeError);

                                function validateAge() {
                                    var age = ageInput.value;
                                    if (age < 1 || age > 112) {
                                        ageError.textContent = "Invalid age. Age must be between 0 and 112.";
                                        ageInput.focus();
                                    } else {
                                        ageError.textContent = "";
                                    }
                                }

                                function clearAgeError() {
                                    ageError.textContent = "";
                                }
                            </script>
                            <!---------------------------------  -->

                            <label for="gender">Gender:</label>
                            <select id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>

                            <input onclick="submitForm1()" type="submit" id="btn-form-1" value="submit">
                        </form>


                        <p id='output1'></p>

                        <script>
                            function submitForm1() {
                                const name = document.getElementById("name").value;
                                const age = document.getElementById("age").value;
                                const gender = document.getElementById("gender").value;
                                document.getElementById("output1").innerHTML = "Is this correct Info?" + " Name: " + name + ", Age: " + age + ", Gender: " + gender;
                            }
                        </script>

                    </section>
                    <section>
                        <h2>Enter User Health Information?</h2>
                        <div class="health-container">
                            <form class="health-form">

                                <!-- chol vs Bp HERE=-------------------------------------------------------------------- -->
                                    <div>
                                        <label class="health-label" for="cholesterol">Cholesterol Level:</label>
                                        <input type="number" class="health-input" id="cholesterol" name="cholesterol" maxlength="3" required>
                                        <span id="cholesterol-error" style="color: red;"></span>
                                    </div>

                                    <div>
                                        <label class="health-label" for="blood-pressure">Blood Pressure:</label>
                                        <input type="number" class="health-input" id="blood-pressure" name="blood_pressure" maxlength="3" required>
                                        <span id="blood-pressure-error" style="color: red;"></span>
                                    </div>

                                    <button onclick="submitHealthInfo()">Data</button>

                                    <div id="plot"></div>

                                    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
                                    <script>
                                        function submitHealthInfo() {
                                            var cholesterol = parseFloat(document.getElementById("cholesterol").value);
                                            var bloodPressure = parseFloat(document.getElementById("blood-pressure").value);
                                            var cholesterolError = document.getElementById("cholesterol-error");
                                            var bloodPressureError = document.getElementById("blood-pressure-error");

                                            var isValid = true;

                                            if (isNaN(cholesterol) || cholesterol < 10 || cholesterol > 500) {
                                                cholesterolError.textContent = "Invalid cholesterol level. Cholesterol level must be between 10 and 500.";
                                                isValid = false;
                                            } else {
                                                cholesterolError.textContent = "";
                                            }

                                            if (isNaN(bloodPressure) || bloodPressure < 50 || bloodPressure > 180) {
                                                bloodPressureError.textContent = "Invalid blood pressure. Blood pressure must be between 50 and 180.";
                                                isValid = false;
                                            } else {
                                                bloodPressureError.textContent = "";
                                            }

                                            if (isValid) {
                                                var userColor = 'black';
                                                var traceColor = 'light grey';

                                                var userData = {x: [cholesterol], y: [bloodPressure], mode: 'markers', type: 'scatter', name: 'User Data', marker: {color: userColor}};

                                                var traceData = {x: [], y: [], mode: 'markers', type: 'scatter', name: 'Heart Data', marker: {color: []}};

                                                Plotly.newPlot('plot', [userData, traceData], {title: 'Resting Blood Pressure vs Cholesterol', xaxis: {title: 'Total Cholesterol mg/dL'}, yaxis: {title: 'Resting Blood Pressure mg/dL'}, boxmode: 'group'});

                                                Plotly.d3.csv('https://raw.githubusercontent.com/KelvinLuk/CSVHEARTDATA/main/heart.csv', function(err, rows){
                                                    // Define x and y arrays using data from heart.csv
                                                    var xArray = [], yArray = [], colorArray = [];
                                                    for(var i=0; i<rows.length; i++){
                                                        xArray.push(rows[i].Cholesterol);
                                                        yArray.push(rows[i].RestingBP);
                                                        var bpRisk = getBPRisk(rows[i].RestingBP);
                                                        var cholRisk = getCholRisk(rows[i].Cholesterol);
                                                        if (bpRisk === 'danger' || cholRisk === 'danger') {
                                                            colorArray.push('red');
                                                        } else if (bpRisk === 'at risk' || cholRisk === 'at risk') {
                                                            colorArray.push('yellow');
                                                        } else {
                                                            colorArray.push('green');
                                                        }
                                                    }

                                                    // Add the heart data to the existing plot
                                                    var traceData = {x: xArray, y: yArray, mode: 'markers', type: 'scatter', name: 'Heart Data', marker: {color: colorArray}};
                                                    Plotly.addTraces('plot', traceData);
                                                });
                                            }
                                        }

                                        function getBPRisk(bp) {
                                            if (bp >= 180) {
                                                return 'danger';
                                            } else if (bp >= 140 && bp <= 179) {
                                                return 'at risk';
                                            } else if (bp >= 120 && bp <= 139) {
                                                return 'elevated';
                                            } else {
                                                return 'normal';
                                            }
                                        }

                                        function getCholRisk(chol) {
                                            if (chol >= 240 || chol <= 50) {
                                                return 'danger';
                                            } else if (chol >= 200 && chol <= 239) {
                                                return 'at risk';
                                            } else {
                                                return 'safe';
                                            }
                                        }

                                    </script>
                                <!------------------------------------------------------------------------------->

                                <label class="health-label">Do You Have Any Existing Illness or Medical Condition?:</label>
                                <div style="padding:0px">
                                    <input type="radio" class="health-input" name="existing_illness value="yes" required> Yes

                                    <input type="text" class="health-input" name="existing_illness">

                                    <input type="radio" class="health-input" name="existing_illness" value="no" required> No

                                    <div style="padding:10px">
                                        <label class="health-label">Do You Exercise?:</label>
                                        <input type="radio" class="health-input" name="exercise" value="yes" required> Yes
                                        <input type="radio" class="health-input" name="exercise" value="no" required> No

                                        <div style="padding:0px">
                                            <label class="health-label">Did you travel:</label>
                                            <input type="radio" class="health-input" name="chest_pain" value="yes" required> Yes
                                            <input type="radio" class="health-input" name="chest_pain" value="no" required> No

                                            <div style="padding:0px">
                                                <label class="health-label">Medical History (such as family history of condition)?:</label>
                                                <input type="radio" class="health-input" name="medical_history" value="yes" required> Yes

                                                <input type="text" class="health-input" name="medical_history">

                                                <input type="radio" class="health-input" name="medical_history" value="no" required> No

                            </form>
                        </div>
                        <h2>Do You Have These Symptoms?</h2>
                        <div class="symptom-container">
                            <form class="symptom-form">


                                <div class="symptom-group">
                                    <label class="symptom-label">Fever:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="fever" value="yes" required> Yes
                                        <input type="radio" name="fever" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Cough:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="cough" value="yes" required> Yes
                                        <input type="radio" name="cough" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Shortness of Breath:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="shortness_of_breath" value="yes" required> Yes
                                        <input type="radio" name="shortness_of_breath" value="no" required> No
                                    </div>
                                </div>


                                <div class="symptom-group">
                                    <label class="symptom-label">Fatigue:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="fatigue" value="yes" required> Yes
                                        <input type="radio" name="fatigue" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Body Aches:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="body_aches" value="yes" required> Yes
                                        <input type="radio" name="body_aches" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Loss of Smell or Taste:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="loss_of_smell_or_taste" value="yes" required> Yes
                                        <input type="radio" name="loss_of_smell_or_taste" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Heart Attack:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="heart_attack" value="yes" required> Yes
                                        <input type="radio" name="heart_attack" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Diabetes:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="diabetes" value="yes" required> Yes
                                        <input type="radio" name="diabetes" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Skin rashes:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="skin_rashes" value="yes" required> Yes
                                        <input type="radio" name="skin_rashes" value="no" required> no
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Headache:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="headache" value="yes" required> Yes
                                        <input type="radio" name="headache" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Sore Throat:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="sore_throat" value="yes" required> Yes
                                        <input type="radio" name="sore_throat" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Runny Nose:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="runny_nose" value="yes" required> Yes
                                        <input type="radio" name="runny_nose" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Nausea or Vomiting:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="nausea_or_vomiting" value="yes" required> Yes
                                        <input type="radio" name="nausea_or_vomiting" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Chills:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="chills" value="yes" required> Yes
                                        <input type="radio" name="chills" value="no" required> No
                                    </div>
                                </div>
                                <div class="symptom-group">
                                    <label class="symptom-label">Chest Pain:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="chest_pain" value="yes" required> Yes
                                        <input type="radio" name="chest_pain" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Swollen of the leg and belly area:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="swollen_of_the_leg_or_belly_area" value="yes" required> Yes
                                        <input type="radio" name="swollen_of_the_leg_or_belly_area" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Swollen feet or Ankle:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="swollen_feet_or_ankle" value="yes" required> Yes
                                        <input type="radio" name="swollen_feet_or_ankle" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Arrhythmia:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="arrhythmia" value="yes" required> Yes
                                        <input type="radio" name="arrhythmia" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Heart Valve Problems:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="heart_valve_problems" value="yes" required> Yes
                                        <input type="radio" name="heart_valve_problems" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Congenital Heart Defects:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="congenital_heart_defects" value="yes" required> Yes
                                        <input type="radio" name="congenital_heart_defects" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Peripheral Artery Disease:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="peripheral_artery_disease" value="yes" required> Yes
                                        <input type="radio" name="peripheral_artery_disease" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Blood Clots:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="blood_clots" value="yes" required> Yes
                                        <input type="radio" name="blood_clots" value="no" required> No
                                    </div>
                                </div>

                                <div class="symptom-group">
                                    <label class="symptom-label">Fainting:</label>
                                    <div class="symptom-radio">
                                        <input type="radio" name="fainting" value="yes" required> Yes
                                        <input type="radio" name="fainting" value="no" required> No
                                    </div>
                                </div>


                            </form>
                            <input type="submit" value="Submit">


                    </section>
                </main
                <style>
                    .image-grid {
                        display: flex;

                    }
                </style>

                <script>
                    // Define the symptoms and their associated weights
                    const symptomWeights = {
                        fever: 1,
                        cough: 1,
                        shortness_of_breath: 2,
                        fatigue: 1,
                        body_aches: 1,
                        loss_of_smell_or_taste: 2,
                        heart_attack: 5,
                        diabetes: 2,
                        high_blood_pressure: 2,
                        headache: 1,
                        sore_throat: 1,
                        runny_nose: 1,
                        nausea_or_vomiting: 1
                    };

                    // Calculate the total weight of the selected symptoms
                    function calculateWeight() {
                        let weight = 0;
                        for (const symptom in symptomWeights) {
                            const value = document.querySelector(`input[name="${symptom}"]:checked`).value;
                            if (value === 'yes') {
                                weight += symptomWeights[symptom];
                            }
                        }
                        return weight;
                    }

                    // Calculate the percentage chance of getting a heart attack
                    function calculatePercentage(weight) {
                        const percentage = Math.min(Math.round(weight / 20 * 100), 100);
                        return percentage;
                    }

                    // Draw the circular chart
                    function drawChart(percentage) {
                        const canvas = document.getElementById('chart');
                        const ctx = canvas.getContext('2d');
                        const centerX = canvas.width / 2;
                        const centerY = canvas.height / 2;
                        const radius = canvas.width / 3;
                        const startAngle = -Math.PI / 2;
                        const endAngle = startAngle + percentage / 100 * 2 * Math.PI;
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.beginPath();
                        ctx.arc(centerX, centerY, radius, startAngle, startAngle + 2 * Math.PI);
                        ctx.strokeStyle = '#ccc';
                        ctx.lineWidth = 30;
                        ctx.stroke();
                        ctx.beginPath();
                        ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                        ctx.strokeStyle = '#f00';
                        ctx.lineWidth = 30;
                        ctx.stroke();
                        ctx.font = 'bold 50px sans-serif';
                        ctx.fillStyle = '#f00';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText(`${percentage}%`, centerX, centerY);
                    }

                    // Display the result text message
                    function displayResult(percentage) {
                        const result = document.getElementById('result');
                        if (percentage >= 50) {
                            result.innerText = 'You have a high chance of getting a heart attack. Please seek medical attention immediately.';
                        } else {
                            result.innerText = 'Your chance of getting a heart attack is low. However, if you have any concerns, please consult a doctor.';
                        }
                    }

                    // Handle the form submission
                    const form = document.querySelector('.symptom-form');
                    form.addEventListener('submit', (event) => {
                        event.preventDefault();
                        const weight = calculateWeight();
                        const percentage = calculatePercentage(weight);
                        drawChart(percentage);
                        displayResult(percentage);
                    });

                    // Add event listeners to symptom radio buttons
                    const symptomRadios = document.querySelectorAll('.symptom-radio input');
                    symptomRadios.forEach(radio => {
                        radio.addEventListener('change', () => {
                            const weight = calculateWeight();
                            const percentage = calculatePercentage(weight);
                            drawChart(percentage);
                            displayResult(percentage);
                        });
                    });

                </script>



                <footer>
                    <p>Copyright &copy;UOP 2023</p>
                </footer>


                <py-script>
                    import js
                    import pandas as pd
                    import matplotlib.pyplot as plt
                    import seaborn

                    from pyodide.http import open_url

                    df = pd.read_csv(open_url("https://raw.githubusercontent.com/KelvinLuk/CSVHEARTDATA/main/heart.csv"))

                    seaborn.scatterplot(data=df, x='Cholesterol', y='RestingBP', hue='Age', style='Sex', palette='coolwarm')

                    plt.title('Resting Blood Pressure vs Cholesterol')
                    plt.xlabel('Cholesterol')
                    plt.ylabel('Resting Blood Pressure')

                    display(plt)
                </py-script>


                <script>
                    function submitAllForms() {
                        const name = document.getElementById("name").value;
                        const age = document.getElementById("age").value;
                        const gender = document.getElementById("gender").value;

                        var cholesterol = parseFloat(document.getElementById("cholesterol").value);
                        var bloodPressure = parseFloat(document.getElementById("blood-pressure").value);
                        var cholesterolError = document.getElementById("cholesterol-error");
                        var bloodPressureError = document.getElementById("blood-pressure-error");

                        var isValid = true;

                        if (isNaN(cholesterol) || cholesterol < 10 || cholesterol > 500) {
                            cholesterolError.textContent = "Invalid cholesterol level. Cholesterol level must be between 10 and 500.";
                            isValid = false;
                        } else {
                            cholesterolError.textContent = "";
                        }

                        if (isNaN(bloodPressure) || bloodPressure < 50 || bloodPressure > 180) {
                            bloodPressureError.textContent = "Invalid blood pressure. Blood pressure must be between 50 and 180.";
                            isValid = false;
                        } else {
                            bloodPressureError.textContent = "";
                        }

                        var plotDiv = document.createElement('div');
                        plotDiv.setAttribute('id', 'final-plot');

                        var outputFinal = document.getElementById("output-final");
                        outputFinal.innerHTML = "Name: " + name + "<br>Age: " + age + "<br>Gender: " + gender;
                        outputFinal.appendChild(plotDiv);

                        if (isValid) {
                            var userColor = 'black';
                            var traceColor = 'light grey';

                            var userData = {x: [cholesterol], y: [bloodPressure], mode: 'markers', type: 'scatter', name: 'User Data', marker: {color: userColor}};

                            var traceData = {x: [], y: [], mode: 'markers', type: 'scatter', name: 'Heart Data', marker: {color: []}};

                            Plotly.newPlot('final-plot', [userData, traceData], {title: 'Resting Blood Pressure vs Cholesterol', xaxis: {title: 'Total Cholesterol mg/dL'}, yaxis: {title: 'Resting Blood Pressure mg/dL'}, boxmode: 'group'});

                            Plotly.d3.csv('https://raw.githubusercontent.com/KelvinLuk/CSVHEARTDATA/main/heart.csv', function(err, rows){
                                // Define x and y arrays using data from heart.csv
                                var xArray = [], yArray = [], colorArray = [];
                                for(var i=0; i<rows.length; i++){
                                    xArray.push(rows[i].Cholesterol);
                                    yArray.push(rows[i].RestingBP);
                                    var bpRisk = getBPRisk(rows[i].RestingBP);
                                    var cholRisk = getCholRisk(rows[i].Cholesterol);
                                    if (bpRisk === 'danger' || cholRisk === 'danger') {
                                        colorArray.push('red');
                                    } else if (bpRisk === 'at risk' || cholRisk === 'at risk') {
                                        colorArray.push('yellow');
                                    } else {
                                        colorArray.push('green');
                                    }
                                }

                                // Add the heart data to the existing plot
                                var traceData = {x: xArray, y: yArray, mode: 'markers', type: 'scatter', name: 'Heart Data', marker: {color: colorArray}};
                                Plotly.addTraces('final-plot', traceData);
                            });
                        }
                        // Get values of radio buttons
                        const fever = document.querySelector('input[name="fever"]:checked').value;
                        const cough = document.querySelector('input[name="cough"]:checked').value;
                        const ShortnessOfBreath = document.querySelector('input[name="Shortness_of_Breath"]:checked').value;
                        const fatigue = document.querySelector('input[name="fatigue"]:checked').value;
                        const bodyaches = document.querySelector('input[name="body_aches"]:checked').value;
                        const lossOfSmellOrTaste = document.querySelector('input[name="loss_of_smell_or_taste"]:checked').value;
                        const heartattack = document.querySelector('input[name="heart_attack"]:checked').value;
                        const diabetes = document.querySelector('input[name="diabetes"]:checked').value;
                        const fainting = document.querySelector('input[name="fainting"]:checked').value;
                        const soreThroat = document.querySelector('input[name="sore_throat"]:checked').value;
                        const runnyNose = document.querySelector('input[name="runny_nose"]:checked').value;
                        const nauseaOrVomiting = document.querySelector('input[name="nausea_or_vomiting"]:checked').value;
                        const chills = document.querySelector('input[name="chills"]:checked').value;
                        const chestPain = document.querySelector('input[name="chest_pain"]:checked').value;
                        const highBloodPressure = document.querySelector('input[name="wollen_of_the_leg_or_belly_area"]:checked').value;
                        const highCholesterol = document.querySelector('input[name="high_cholesterol"]:checked').value;
                        const arrhythmia = document.querySelector('input[name="arrhythmia"]:checked').value;
                        const bloodclots = document.querySelector('input[name="blood_clots"]:checked').value;
                        const PeripheralArteryDisease = document.querySelector('input[name="peripheral_artery_disease"]:checked').value;
                        const CongenitalHeartDefects = document.querySelector('input[name="congenital_heart_defects"]:checked').value;
                        const HeartValveProblems = document.querySelector('input[name="heart_valve_problems"]:checked').value;
                        const SwollenFeetOrAnkle = document.querySelector('input[name="swollen_feet_or_ankle"]:checked').value;
                        const SkinRashes= document.querySelector('input[name="skin_rashes"]:checked').value;

                        // Calculate risk score
                        let riskScore = 0;

                        if (fever === 'yes') {
                            riskScore += 10;
                        }

                        if (cough === 'yes') {
                            riskScore += 8;
                        }

                        if (ShortnessOfBreath === 'yes') {
                            riskScore += 15;
                        }

                        if (fatigue === 'yes') {
                            riskScore += 5;
                        }

                        if (bodyaches === 'yes') {
                            riskScore += 3;
                        }

                        if (lossOfSmellOrTaste === 'yes') {
                            riskScore += 7;
                        }

                        if (heartattack === 'yes') {
                            riskScore += 30;
                        }

                        if (diabetes === 'yes') {
                            riskScore += 25;
                        }

                        if (fainting === 'yes') {
                            riskScore += 20;
                        }

                        if (soreThroat === 'yes') {
                            riskScore += 5;
                        }

                        if (runnyNose === 'yes') {
                            riskScore += 3;
                        }

                        if (nauseaOrVomiting === 'yes') {
                            riskScore += 7;
                        }

                        if (chills === 'yes') {
                            riskScore += 4;
                        }

                        if (chestPain === 'yes') {
                            riskScore += 10;
                        }

                        if (highBloodPressure === 'yes') {
                            riskScore += 8;
                        }

                        if (highCholesterol === 'yes') {
                            riskScore += 5;
                        }

                        if (arrhythmia === 'yes') {
                            riskScore += 15;
                        }

                        if (bloodclots === 'yes') {
                            riskScore += 25;
                        }

                        if (PeripheralArteryDisease === 'yes') {
                            riskScore += 10;
                        }

                        if (CongenitalHeartDefects === 'yes') {
                            riskScore += 20;
                        }

                        if (HeartValveProblems === 'yes') {
                            riskScore += 15;
                        }

                        if (SwollenFeetOrAnkle === 'yes') {
                            riskScore += 5;
                        }

                        if (SkinRashes === 'yes') {
                            riskScore += 3;
                        }

                        // Calculate remaining score out of 100
                        const remainingScore = 100 - riskScore;

                        // Create chart
                        const data = [
                            {
                                values: [riskScore, remainingScore],
                                labels: ['Risk Score', 'Remaining Score'],
                                hole: 0.5,
                                type: 'pie',
                                marker: {
                                    colors: ['#FF4136', '#DDDDDD'],
                                },
                            },
                        ];

                        const layout = {
                            title: 'Risk Score Chart',
                        };

                        Plotly.newPlot('myPlot', data, layout);

                        return false; // Prevent form from submitting and reloading the page
                    }






                </script>

                <scrip>
                    <form onsubmit="return false">


                        <input onclick="submitAllForms()" type="submit" id="btn-final-submit" value="Submit All">
                    </form>

                    <p>Final Output:</p>
                    <p id='output-final'></p>

                </scrip>



                <div id="myPlot" style="width:100%;max-width:700px"></div>
                <h2>Do You Have These Symptoms?</h2>
                <div class="symptom-container">
                    <form class="symptom-form" onsubmit="return generateChart()">

                        <div class="symptom-group">
                            <label class="symptom-label">Sore Throat:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="sore_throat" value="yes" required> Yes
                                <input type="radio" name="sore_throat" value="no" required> No
                            </div>
                        </div>
                        <div class="symptom-group">
                            <label class="symptom-label">Runny Nose:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="runny_nose" value="yes" required> Yes
                                <input type="radio" name="runny_nose" value="no" required> No
                            </div>
                        </div>
                        <div class="symptom-group">
                            <label class="symptom-label">Nausea or Vomiting:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="nausea_or_vomiting" value="yes" required> Yes
                                <input type="radio" name="nausea_or_vomiting" value="no" required> No
                            </div>
                        </div>
                        <div class="symptom-group">
                            <label class="symptom-label">Chills:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="chills" value="yes" required> Yes
                                <input type="radio" name="chills" value="no" required> No
                            </div>
                        </div>
                        <div class="symptom-group">
                            <label class="symptom-label">Chest Pain:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="chest_pain" value="yes" required> Yes
                                <input type="radio" name="chest_pain" value="no" required> No
                            </div>
                        </div>

                        <div class="symptom-group">
                            <label class="symptom-label">High Blood Pressure:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="high_blood_pressure" value="yes" required> Yes
                                <input type="radio" name="high_blood_pressure" value="no" required> No
                            </div>
                        </div>

                        <div class="symptom-group">
                            <label class="symptom-label">High Cholesterol:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="high_cholesterol" value="yes" required> Yes
                                <input type="radio" name="high_cholesterol" value="no" required> No
                            </div>
                        </div>

                        <div class="symptom-group">
                            <label class="symptom-label">Arrhythmia:</label>
                            <div class="symptom-radio">
                                <input type="radio" name="arrhythmia"  value="yes" required> yes
                                <input type="radio" name="arrhythmia" value="no" required> No
                            </div>
                        </div>
                        <button type="submit">Submit</button>
                    </form>
                </div>
                <div class="chart-container">
                    <canvas id="chart"></canvas>
                </div>
                <script>
                    function generateChart() {}

                </script>






                </body>

                </html>


///////////////////////////////////////////////////////////////////////
<div id="myPlot" style="width:100%;max-width:700px"></div>
<h2>Do You Have These Symptoms?</h2>
<div class="symptom-container">
    <form class="symptom-form" onsubmit="return generateChart()">

        <div class="symptom-group">
            <label class="symptom-label">Shortness of Breath:</label>
            <div class="symptom-radio">
                <input type="radio" name="shortness_of_breath" value="yes" required> Yes
                <input type="radio" name="shortness_of_breath" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Swollen leg Or Belly:</label>
            <div class="symptom-radio">
                <input type="radio" name="swollenlegOrBelly" value="yes" required> Yes
                <input type="radio" name="swollenlegOrBelly" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Dizziness or Lightheadedness:</label>
            <div class="symptom-radio">
                <input type="radio" name="dizzy" value="yes" required> Yes
                <input type="radio" name="dizzy" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Numbness in the Legs or Arms:</label>
            <div class="symptom-radio">
                <input type="radio" name="numbness" value="yes" required> Yes
                <input type="radio" name="numbness" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Chest Pain:</label>
            <div class="symptom-radio">
                <input type="radio" name="chest_pain" value="yes" required> Yes
                <input type="radio" name="chest_pain" value="no" required> No
            </div>
        </div>




        <div class="symptom-group">
            <label class="symptom-label">Arrhythmia:</label>
            <div class="symptom-radio">
                <input type="radio" name="arrhythmia"  value="yes" required> yes
                <input type="radio" name="arrhythmia" value="no" required> No
            </div>
        </div>


        <div class="symptom-group">
            <label class="symptom-label">Swollen feet or Ankle:</label>
            <div class="symptom-radio">
                <input type="radio" name="swollen_feet_or_ankle" value="yes" required> Yes
                <input type="radio" name="swollen_feet_or_ankle" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Fatigue:</label>
            <div class="symptom-radio">
                <input type="radio" name="fatigue" value="yes" required> Yes
                <input type="radio" name="fatigue" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Fainting:</label>
            <div class="symptom-radio">
                <input type="radio" name="fainting" value="yes" required> Yes
                <input type="radio" name="fainting" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Skin rash:</label>
            <div class="symptom-radio">
                <input type="radio" name="Rash" value="yes" required> Yes
                <input type="radio" name="Rash" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Pain in the neck, back, jaw, upperbelly, throat:</label>
            <div class="symptom-radio">
                <input type="radio" name="PainNB" value="yes" required> Yes
                <input type="radio" name="PainNB" value="no" required> No
            </div>
        </div>



        <div class="symptom-group">
            <label class="symptom-label">Congenital Heart Defects:</label>
            <div class="symptom-radio">
                <input type="radio" name="congenital_heart_defects" value="yes" required> Yes
                <input type="radio" name="congenital_heart_defects" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Peripheral Artery Disease:</label>
            <div class="symptom-radio">
                <input type="radio" name="peripheral_artery_disease" value="yes" required> Yes
                <input type="radio" name="peripheral_artery_disease" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Blood Clots:</label>
            <div class="symptom-radio">
                <input type="radio" name="blood_clots" value="yes" required> Yes
                <input type="radio" name="blood_clots" value="no" required> No
            </div>
        </div>
        <div class="symptom-group">
            <label class="symptom-label">Heart Attack:</label>
            <div class="symptom-radio">
                <input type="radio" name="heart_attack" value="yes" required> Yes
                <input type="radio" name="heart_attack" value="no" required> No
            </div>
        </div>

        <button type="submit">Submit</button>
    </form>
</div>
 ///////////////////////////////////////////////////////////////
 <!DOCTYPE html>
 <html>

 <head>
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width">
     <title>replit</title>
     <link href="style.css" rel="stylesheet" type="text/css" />
 </head>

 <body>
 <form onsubmit="return false">
     <label for="name">Name: </label><br>
     <input type="text" id="name" name="name" value="Test"><br>
     <select name="countries" id="countries">
         <option value="America">America</option>
         <option value="Europe">Europe</option>
         <option value="Asia">Asia</option>
     </select>
     <input onclick="submitForm1()" type="submit" id="btn-form-1" value="submit">
 </form>
 <p>Output:</p>
 <p id='output1'></p>

 <form onsubmit="return false">
     <label for="age">Age: </label><br>
     <input type="text" id="age" name="age" value="30"><br>
     <select name="gender" id="gender">
         <option value="male">Male</option>
         <option value="female">Female</option>
         <option value="other">Other</option>
     </select>
     <input onclick="submitForm2()" type="submit" id="btn-form-2" value="submit">
 </form>
 <p>Output:</p>
 <p id='output2'></p>

 <form onsubmit="return false">
     <input onclick="submitAllForms()" type="submit" id="btn-final-submit" value="Submit All">
 </form>

 <p>Final Output:</p>
 <p id='output-final'></p>

 <script>
     function submitForm1() {
         const name = document.getElementById("name").value;
         const country = document.getElementById("countries").value;
         document.getElementById("output1").innerHTML = "Name: " + name + "<br>Country: " + country;
     }

     function submitForm2() {
         const age = document.getElementById("age").value;
         const gender = document.getElementById("gender").value;
         document.getElementById("output2").innerHTML = "Age: " + age + "<br>Gender: " + gender;
     }

     function submitAllForms() {
         const name = document.getElementById("name").value;
         const country = document.getElementById("countries").value;
         const age = document.getElementById("age").value;
         const gender = document.getElementById("gender").value;

         document.getElementById("output-final").innerHTML =
             "Name: " + name + "<br>Country: " + country + "<br>Age: " + age + "<br>Gender: " + gender;
     }
 </script>
 </body>







 </html>
